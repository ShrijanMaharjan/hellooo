<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shop UI</title>
    <style>
      body {
        font-family: Arial;
        padding: 20px;
      }
      .product,
      .cart-item {
        border: 1px solid #ccc;
        padding: 10px;
        margin: 10px 0;
      }
      button {
        padding: 6px 10px;
      }
    </style>
  </head>
  <body>
    <h1>Product List</h1>
    <div id="product-list"></div>

    <h2>Your Cart</h2>
    <div id="cart"></div>

    <h2>Total</h2>
    <p id="total">$0</p>

    <button onclick="checkout()">Checkout</button>

    <h2>Wishlist</h2>
    <div id="wishlist"></div>

    <script type="module">
      const products = [
        {
          id: 1,
          name: "Black Oversized T-Shirt",
          price: 20,
          discount: 10,
          vat: 5,
        },
        { id: 2, name: "Floral Summer Dress", price: 40, discount: 15, vat: 5 },
      ];

      let cart = [];
      let wishlist = [];

      function renderProducts() {
        const list = document.getElementById("product-list");
        list.innerHTML = "";
        products.forEach((p) => {
          list.innerHTML += `
          <div class='product'>
            <h3>${p.name}</h3>
            <p>Price: $${p.price}</p>
            <p>Discount: ${p.discount}% | VAT: ${p.vat}%</p>
            <button onclick='addToCart(${p.id})'>Add to Cart</button>
            <button onclick='addToWishlist(${p.id})'>Add to Wishlist</button>
          </div>`;
        });
      }

      window.addToCart = function (id) {
        const item = cart.find((c) => c.id === id);
        const product = products.find((p) => p.id === id);

        if (item) item.quantity++;
        else cart.push({ ...product, quantity: 1 });

        renderCart();
      };

      function renderCart() {
        const c = document.getElementById("cart");
        c.innerHTML = "";

        cart.forEach((i) => {
          const discounted = i.price - (i.price * i.discount) / 100;
          const vatAdded = discounted + (discounted * i.vat) / 100;

          c.innerHTML += `
          <div class='cart-item'>
            ${i.name} - $${i.price} x ${i.quantity}<br>
            Discounted: $${discounted.toFixed(
              2
            )} | With VAT: $${vatAdded.toFixed(2)}
          </div>`;
        });

        document.getElementById("total").innerText = "$" + calculateTotal();
      }

      function calculateTotal() {
        let total = 0;
        cart.forEach((item) => {
          let discounted = item.price - (item.price * item.discount) / 100;
          let vatAdded = discounted + (discounted * item.vat) / 100;
          total += vatAdded * item.quantity;
        });
        return total.toFixed(2);
      }

      window.addToWishlist = function (id) {
        const product = products.find((p) => p.id === id);
        if (!wishlist.find((w) => w.id === id)) wishlist.push(product);
        renderWishlist();
      };

      function renderWishlist() {
        const w = document.getElementById("wishlist");
        w.innerHTML = "";

        wishlist.forEach((i) => {
          w.innerHTML += `
          <div class='cart-item'>
            ${i.name} - $${i.price} (Disc: ${i.discount}% | VAT: ${i.vat}%)
            <button onclick='addToCart(${i.id})'>Move to Cart</button>
          </div>`;
        });
      }

      window.checkout = function () {
        alert("Total payable: $" + calculateTotal());
      };

      renderProducts();
    </script>
  </body>
</html>
